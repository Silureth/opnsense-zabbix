zabbix_export:
  version: '6.0'
  date: '2025-06-19T13:19:29Z'
  groups:
    -
      uuid: 4918b88734c54bd094cff7585b5d71fc
      name: 'Templates/Network Devices'
  templates:
    -
      uuid: 76aa5b715b7d4b4aabdf5dca58ed68b2
      template: 'Template opnSense Active IPsec Swan'
      name: 'OPNSense Active: IPsec Swan'
      description: |
        Active template for opnsense, requires opnsense_zbx.php installed to OPNSense Box.
        Monitor IPsec Swan VPN.
                        
        Version 1.0.0
        
        https://github.com/dblanque/opnsense-zabbix
      groups:
        -
          name: 'Templates/Network Devices'
      discovery_rules:
        -
          uuid: 5d99ec27490948b1a22b6e1bb87cf8cc
          name: 'IPsec Swan Connections Discovery'
          type: ZABBIX_ACTIVE
          key: 'opnsense.discovery[ipsec_swan_connections]'
          delay: 1200s
          description: 'Discovery of IPsec Swan Connections'
          item_prototypes:
            -
              uuid: c0d4547c59484058a467fef5b3c098b3
              name: 'IPsec Swan Connection {#NAME} Enabled ({#IKEID})'
              type: ZABBIX_ACTIVE
              key: 'opnsense.value[ipsec_swan,{#IKEID},enabled]'
              delay: 120s
              description: 'IPsec Connection Enabled'
              valuemap:
                name: 'opnSense IPsec Enabled'
              tags:
                -
                  tag: Application
                  value: IPsec
            -
              uuid: 2d885e23a8854dee9cee39ea5d8668d5
              name: 'IPsec Swan Connection {#NAME} IKE Type ({#IKEID})'
              type: ZABBIX_ACTIVE
              key: 'opnsense.value[ipsec_swan,{#IKEID},version]'
              delay: 600s
              description: 'IPsec Connection IKE Type'
              value_type: TEXT
              tags:
                -
                  tag: Application
                  value: IPsec
            -
              uuid: 5c0df37416be4fa39e9acb50b73c26b4
              name: 'IPsec Swan Connection {#NAME} MOBIKE ({#IKEID})'
              type: ZABBIX_ACTIVE
              key: 'opnsense.value[ipsec_swan,{#IKEID},mobike]'
              delay: 600s
              description: 'IPsec Connection MOBIKE'
              valuemap:
                name: 'opnSense IPsec MOBIKE'
              tags:
                -
                  tag: Application
                  value: IPsec
            -
              uuid: 6325229ec5be4d0d90de5034f8cca59e
              name: 'IPsec Swan Connection {#NAME} Tunnel Mode ({#IKEID})'
              type: ZABBIX_ACTIVE
              key: 'opnsense.value[ipsec_swan,{#IKEID},aggressive]'
              delay: 600s
              description: 'IPsec Connection Tunnel Mode'
              valuemap:
                name: 'opnSense IPsec Tunnel Mode'
              tags:
                -
                  tag: Application
                  value: IPsec
            -
              uuid: 1c7c0bf5479e45a8b513a82aaee6ea3b
              name: 'IPsec Swan Connection {#NAME} Remote Gateway(s) ({#IKEID})'
              type: ZABBIX_ACTIVE
              key: 'opnsense.value[ipsec_swan,{#IKEID},remote_addrs]'
              delay: 600s
              trends: '0'
              value_type: TEXT
              description: 'IPsec Swan Connection Remote Gateway(s)'
              tags:
                -
                  tag: Application
                  value: IPsec
            -
              uuid: 1c7c0bf5479e45a8b513a82aaee6ea3b
              name: 'IPsec Swan Connection {#NAME} Local Gateway(s) ({#IKEID})'
              type: ZABBIX_ACTIVE
              key: 'opnsense.value[ipsec_swan,{#IKEID},local_addrs]'
              delay: 600s
              trends: '0'
              value_type: TEXT
              description: 'IPsec Swan Connection Local Gateway(s)'
              tags:
                -
                  tag: Application
                  value: IPsec
            -
              uuid: 0f06128058714627865976c6e52fa3f3
              name: 'IPsec Swan Connection {#NAME} Status ({#IKEID})'
              type: ZABBIX_ACTIVE
              key: 'opnsense.value[ipsec_swan,{#IKEID},status]'
              delay: 60s
              description: 'IPsec Swan Connection Status'
              value_type: TEXT
              tags:
                -
                  tag: Application
                  value: IPsec
          trigger_prototypes:
            -
              uuid: d3427e0d7e30413484bf77e09b17fe53
              expression: 'last(/Template opnSense Active IPsec Swan/opnsense.value[ipsec_swan,{#IKEID},enabled])=1 and last(/Template opnSense Active IPsec Swan/opnsense.value[ipsec_swan,{#IKEID},status])<>"ESTABLISHED" and last(/Template opnSense Active IPsec Swan/opnsense.value[ipsec_swan,{#IKEID},children])<>"INSTALLED"'
              name: 'IPsec Swan Connection ({#NAME}) Not Connected ({#IKEID})'
              priority: HIGH
              description: 'IPsec Swan Connection is not connected.'
        -
          uuid: 414e60a982cd49f3bb2a35eda800293b
          name: 'IPsec Swan Children Discovery'
          type: ZABBIX_ACTIVE
          key: 'opnsense.discovery[ipsec_swan_children]'
          delay: 1200s
          description: 'Discovery of IPsec Swan Children'
          item_prototypes:
            -
              uuid: 83a2181db5464d5698a966eafab8a33e
              name: 'IPsec Swan Child {#NAME} Enabled ({#IKEID}.{#REQID})'
              type: ZABBIX_ACTIVE
              key: 'opnsense.value[ipsec_swan,{#IKEID},enabled,children]'
              delay: 120s
              description: 'IPsec Swan Child Protocol'
              valuemap:
                name: 'opnSense IPsec Enabled'
              tags:
                -
                  tag: Application
                  value: IPsec
            -
              uuid: 28099d05480247e29d23afe77a5a9a8b
              name: 'IPsec Swan Child {#NAME} Mode ({#IKEID}.{#REQID})'
              type: ZABBIX_ACTIVE
              key: 'opnsense.value[ipsec_swan,{#UNIQID},mode,children]'
              delay: 600s
              value_type: TEXT
              description: 'IPsec Swan Child Mode'
              tags:
                -
                  tag: Application
                  value: IPsec                                
            -
              uuid: 245eed965cb4486187282fbe41acb330
              name: 'IPsec Swan Child {#NAME} Re-key Time ({#IKEID}.{#REQID})'
              type: ZABBIX_ACTIVE
              key: 'opnsense.value[ipsec_swan,{#UNIQID},rekey_time,children]'
              delay: 600s
              units: s
              description: 'IPsec Swan Child  Re-key Time'
              tags:
                -
                  tag: Application
                  value: IPsec
            -
              uuid: 0f061280587146X7865976c6e52fa3f3
              name: 'IPsec Swan Child {#NAME} Status ({#IKEID}.{#REQID})'
              type: ZABBIX_ACTIVE
              key: 'opnsense.value[ipsec_swan,{#IKEID},status,children]'
              delay: 60s
              description: 'IPsec Swan Child Status'
              value_type: TEXT
              tags:
                -
                  tag: Application
                  value: IPsec
      valuemaps:
        -
          uuid: a15f750487f5429c92ff5e1d6a81ae1f
          name: 'opnSense IPsec Enabled'
          mappings:
            -
              value: '1'
              newvalue: 'Yes'
            -
              value: '0'
              newvalue: 'No'
        -
          uuid: a15f750487f5429cn2ff5e1d6a81ae1f
          name: 'opnSense IPsec MOBIKE'
          mappings:
            -
              value: '1'
              newvalue: 'Yes'
            -
              value: '0'
              newvalue: 'No'
        -
          uuid: 3f481d2513894d6bb3f624a2d8a951ec
          name: 'opnSense IPsec Tunnel Mode'
          mappings:
            -
              value: '0'
              newvalue: Main
            -
              value: '1'
              newvalue: Aggressive
